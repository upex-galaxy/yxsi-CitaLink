import { NextResponse } from "next/server";
type Row = { id: string; patientName: string; appointmentDateTime: string; totalAmount: number; depositAmount: number; status: "pending"|"confirmed"|"expired" };
const mem: Row[] = [];
export async function POST(req: Request) {
  const body = await req.json();
  const pct = 30; // TODO: leer de ajustes
  const row: Row = {
    id: Math.random().toString(36).slice(2),
    patientName: body.patientName,
    appointmentDateTime: body.appointmentDateTime,
    totalAmount: Number(body.totalAmount||0),
    depositAmount: Math.round(Number(body.totalAmount||0)*pct)/100,
    status: "pending",
  };
  mem.push(row);
  return NextResponse.json({ ok:true, id:row.id, url:`/pay/${row.id}` });
}
